---
id: api-specification
title: Test Driven API Specification
sidebar_label: ðŸ“š API Specification
order: 9
---

The API specification is the best way to visully know what are the services exposed by the microservice.
On day to day basis, keeping the API specification up to date is definetly the key challenge for every project... 

Everyone fails using different ways:
* ðŸ‘Ž Failing to keep it up to date using manual entry
* ðŸ‘Ž Failing to keep it up to date using comment in the code
* ðŸ‘Ž Failing to keep it up to date using ORM type


*RestQA took the opinionated approach to generate the API specification from the actual traffic generated from the running test scenario.*

### Key benefits

Let's try to list the great benefits on using test driven API specification

#### Visual Testing

Since the API specification is generated from the test scenario that are running, it means we could identified visually on the API specification if a parameter is missing.

Example: 
> Our Microservice User has a `GET /user` endpoint that could fetch information using the 2 optionals parameter `firstname` and `lastname`. <br/> However on the API specification we can only see the `firstname` parameter appears... WHY??? <br/> Then it simply means that the scenario testing the lastname parameter is missing ðŸ˜€ 


#### Matching Api Example

Since the API specification are generated by the actual test scenario, the information that will be share in the example as reference will be information from your own test.
Amazing right? We all felt the pain on having the right API schema aligned but example shared mismatched the reality...
No more issue now... Update your tests then the example will match the reality

#### No maintenance

Nothing to add on your code, or configuration... Add one line in your `.restqa.yml` and it's done.

#### Multiple levels

Runing test locally is great but running test on the integrated environment can come with a different challenge.
Maybe your gateway will add some specific headers, or requires some security check...
That what is great with Test Driven API specification:
* If you run your test locally you will get the API specification that is required by the team to work effectivelly
* If you run the integration on a specification environment you will get the API specification that you can share with an other team to access your service from the main API gateway.

Isn't it awesome ? ðŸš€

### Getting Started

Setting up your API specification, by following the instruction: [here](/#/specification)


#### Options


| *Property*                       | type           | *Description*                                                    | *Required* | *Default*                      |
|:---------------------------------|:---------------| -----------------------------------------------------------------|------------|:-------------------------------|
| `specification.tool`             | string         | The tool that you plan to use to render the api specification    | Yes        |                                |
| `specification.title`            | string         | Override the default title on the API specification              | No         | Title from `.restqa.yml`       |
| `specification.description`      | string         | Override the defaul description on the API specification         | No         | Description from `.restqa.yml` |
| `specification.matches`          | object         | List of matchers                                                 | No         |                                |
| `specification.matches.ids`      | array <regexp> | Array of Regexp that would match  unique Id                      | No         |                                |
| `specification.excludes`         | object         | Information to not display on the api specification              | No         |                                |
| `specification.excludes.paths`   | array <string> | Path to exclude                                                  | No         |                                |
| `specification.excludes.queries` | array <string> | Query parameter to exclude                                       | No         |                                |
| `specification.headers`          | object         | Headers to display on the api specification                      | No         |                                |
| `specification.headers.request`  | array <string> | Header from the request to include                               | No         |                                |
| `specification.headers.response` | array <string> | Header from the response to include                              | No         |                                |
| `specification.tags`             | object [array] | Ordering endpoints per sections                                  | No         |                                |


#### Example

```
specification:
  tool: swagger
  title: Users Product
  description: |>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vehicula nunc sodales metus consectetur posuere.
    Curabitur id viverra odio, at fermentum leo. Proin bibendum sed lectus nec sodales.
    Nam in ultrices mi. Nullam vehicula at ante eu lacinia.
    In bibendum, dolor tincidunt suscipit volutpat
  matches:
    ids:
    - "/^(\d+)\@/" # example: 23434
    - "/^(\d+)/" example: 23243
    - "/^[a-zA-Z0-9]+\=$/" example: NjEwMjI2NzU=
  excludes:
    paths:
    - '/payments/qr'
    queries:
    - 'cached'
  headers:
    request:
     - 'accept-language'
    response:
     - 'x-artefact-name'
  tags:
    users: # will create a tag users including  the endpoint specified
      - /users
      - /users/{id}
```
